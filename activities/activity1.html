<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Housing Market Analysis - Principles of Macroeconomics</title>
    <link rel="stylesheet" href="../css/style.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js for data visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Papa Parse for CSV parsing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-blue-700 text-white">
        <div class="container mx-auto py-6 px-4">
            <div class="flex items-center mb-2">
                <a href="index.html" class="text-blue-100 hover:text-white mr-2">← Back to Activities</a>
            </div>
            <h1 class="text-3xl font-bold">Discussion Activity 1: Housing Market Analysis</h1>
            <p class="mt-2 text-blue-100">April 1-4, 2025</p>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto py-8 px-4">
        <!-- Progress Indicator -->
        <div class="mb-8">
            <div class="flex justify-between mb-2">
                <span id="progress-label" class="text-sm font-medium">Step 1: Instructions</span>
                <span id="progress-counter" class="text-sm text-gray-500">Step 1 of 5</span>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-2.5">
                <div id="progress-bar" class="bg-blue-600 h-2.5 rounded-full" style="width: 20%"></div>
            </div>
        </div>

        <!-- Tabs -->
        <div class="bg-white rounded-lg shadow-md overflow-hidden">
            <div class="border-b">
                <div class="flex overflow-x-auto">
                    <button id="tab-instructions" class="tab-btn px-6 py-3 font-medium border-b-2 border-blue-600 text-blue-600">Instructions</button>
                    <button id="tab-state" class="tab-btn px-6 py-3 font-medium border-b-2 border-transparent">Choose State</button>
                    <button id="tab-analysis" class="tab-btn px-6 py-3 font-medium border-b-2 border-transparent">Market Analysis</button>
                    <button id="tab-data" class="tab-btn px-6 py-3 font-medium border-b-2 border-transparent">Data Visualization</button>
                    <button id="tab-ai" class="tab-btn px-6 py-3 font-medium border-b-2 border-transparent">AI Feedback</button>
                </div>
            </div>
            
            <!-- Tab Content -->
            <div class="p-6">
                <!-- Instructions Tab -->
                <div id="content-instructions" class="tab-content">
                    <h2 class="text-2xl font-semibold mb-4">Activity Instructions</h2>
                    <div class="space-y-6">
                        <div>
                            <h3 class="text-lg font-medium">Objective</h3>
                            <p>In this activity, you and your group (of 2 to 3) will identify whether the housing market in a U.S. state is healthy or not by analyzing recent housing metrics data.</p>
                        </div>
                        
                        <div>
                            <h3 class="text-lg font-medium">Overview of Steps</h3>
                            <ol class="list-decimal pl-5 space-y-2 mt-2">
                                <li>Choose a state for analysis using the TA-provided QR code</li>
                                <li>Access housing market data from Redfin Data Center</li>
                                <li>Assign weights and values to each metric in Part 1</li>
                                <li>Get AI feedback on your state's housing market in Part 2</li>
                                <li>Compare your analysis with the AI assessment</li>
                            </ol>
                        </div>
                        
                        <div>
                            <h3 class="text-lg font-medium">Key Housing Metrics</h3>
                            <div class="mt-3 space-y-4">
                                <div class="p-4 bg-blue-50 rounded-lg">
                                    <h4 class="font-medium">Median Sale Price</h4>
                                    <p>The middle value of all home sale prices for a given period. Half of the homes sold were priced above this value, and half were below.</p>
                                    <p class="mt-1 italic text-sm">A balanced market has 3-5% growth in prices per year.</p>
                                </div>
                                
                                <div class="p-4 bg-green-50 rounded-lg">
                                    <h4 class="font-medium">Months' Supply (Months of Inventory)</h4>
                                    <p>Number of months it would take to sell all the homes on the market, given the current pace of sales.</p>
                                    <p class="mt-1 italic text-sm">A balanced market has 4-6 months of supply.</p>
                                </div>
                                
                                <div class="p-4 bg-yellow-50 rounded-lg">
                                    <h4 class="font-medium">Days on Market</h4>
                                    <p>The average number of days a home is listed for sale before it goes under contract (sold).</p>
                                    <p class="mt-1 italic text-sm">In a balanced market, homes usually sell within 30-60 days.</p>
                                </div>
                                
                                <div class="p-4 bg-purple-50 rounded-lg">
                                    <h4 class="font-medium">Sale-to-List</h4>
                                    <p>A measure of how close the sale price is to the asking price set by the seller. Specifically (Sale Price/List Price) × 100.</p>
                                    <p class="mt-1 italic text-sm">A sale-to-list price ratio between 98% to 102% is consistent with a balanced market.</p>
                                </div>
                                
                                <div class="p-4 bg-red-50 rounded-lg">
                                    <h4 class="font-medium">Price Drops</h4>
                                    <p>The percentage of active home listings in a market that have had at least one price reduction from their original list price.</p>
                                    <p class="mt-1 italic text-sm">In a balanced market, price drops range between 10% and 20%.</p>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <h3 class="text-lg font-medium">Accessing Housing Data</h3>
                            <p class="mb-2">To gather data for your assigned state, follow these steps:</p>
                            <ol class="list-decimal pl-5 space-y-2">
                                <li>Your TA will show a QR code that links to a Google Sheet</li>
                                <li>Claim your state by entering your group name next to the state (first come, first served)</li>
                                <li>Go to the <a href="https://www.redfin.com/news/data-center/" class="text-blue-600 underline" target="_blank">Redfin Data Center</a></li>
                                <li>Find the "Redfin Monthly Housing Market Data" section</li>
                                <li>Remove metro areas by clicking "Region Type" and unchecking "County", "Metro", and "Place/City"</li>
                                <li>Keep "National" and "State" checked</li>
                                <li>Click on "Region" and select your assigned state</li>
                                <li>Click "Apply" to see the data</li>
                                <li>Explore each metric by clicking on different tabs (Median Sale Price, Months' Supply, etc.)</li>
                            </ol>
                        </div>
                        
                        <button id="next-to-state" class="mt-6 bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700">Next: Choose Your State</button>
                    </div>
                </div>
                
                <!-- State Selection Tab -->
                <div id="content-state" class="tab-content hidden">
                    <h2 class="text-2xl font-semibold mb-4">Step 1: Choose Your State</h2>
                    
                    <div class="mb-6">
                        <div class="p-4 bg-yellow-50 rounded-lg mb-4">
                            <h3 class="font-medium">State Selection Process:</h3>
                            <ol class="list-decimal pl-5 space-y-1 mt-2">
                                <li>Your TA will display a QR code linking to a Google Sheet</li>
                                <li>Scan the QR code to access the sheet</li>
                                <li>Enter your group name next to your desired state (first come, first served)</li>
                                <li>Once you've claimed your state, enter it below</li>
                            </ol>
                        </div>
                        
                        <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="state-select" class="block text-gray-700 mb-2">Your assigned state:</label>
                                <select id="state-select" class="w-full border rounded p-2">
                                    <option value="">Select a state</option>
                                    <option value="AL">Alabama</option>
                                    <option value="AK">Alaska</option>
                                    <option value="AZ">Arizona</option>
                                    <option value="AR">Arkansas</option>
                                    <option value="CA">California</option>
                                    <option value="CO">Colorado</option>
                                    <option value="CT">Connecticut</option>
                                    <option value="DE">Delaware</option>
                                    <option value="FL">Florida</option>
                                    <option value="GA">Georgia</option>
                                    <option value="HI">Hawaii</option>
                                    <option value="ID">Idaho</option>
                                    <option value="IL">Illinois</option>
                                    <option value="IN">Indiana</option>
                                    <option value="IA">Iowa</option>
                                    <option value="KS">Kansas</option>
                                    <option value="KY">Kentucky</option>
                                    <option value="LA">Louisiana</option>
                                    <option value="ME">Maine</option>
                                    <option value="MD">Maryland</option>
                                    <option value="MA">Massachusetts</option>
                                    <option value="MI">Michigan</option>
                                    <option value="MN">Minnesota</option>
                                    <option value="MS">Mississippi</option>
                                    <option value="MO">Missouri</option>
                                    <option value="MT">Montana</option>
                                    <option value="NE">Nebraska</option>
                                    <option value="NV">Nevada</option>
                                    <option value="NH">New Hampshire</option>
                                    <option value="NJ">New Jersey</option>
                                    <option value="NM">New Mexico</option>
                                    <option value="NY">New York</option>
                                    <option value="NC">North Carolina</option>
                                    <option value="ND">North Dakota</option>
                                    <option value="OH">Ohio</option>
                                    <option value="OK">Oklahoma</option>
                                    <option value="OR">Oregon</option>
                                    <option value="PA">Pennsylvania</option>
                                    <option value="RI">Rhode Island</option>
                                    <option value="SC">South Carolina</option>
                                    <option value="SD">South Dakota</option>
                                    <option value="TN">Tennessee</option>
                                    <option value="TX">Texas</option>
                                    <option value="UT">Utah</option>
                                    <option value="VT">Vermont</option>
                                    <option value="VA">Virginia</option>
                                    <option value="WA">Washington</option>
                                    <option value="WV">West Virginia</option>
                                    <option value="WI">Wisconsin</option>
                                    <option value="WY">Wyoming</option>
                                </select>
                            </div>
                            
                            <div>
                                <label for="group-members" class="block text-gray-700 mb-2">Group members (names and perm #s):</label>
                                <textarea id="group-members" class="w-full border rounded p-2" rows="3" placeholder="Enter names and perm #s of all group members"></textarea>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-between mt-6">
                        <button id="back-to-instructions" class="bg-gray-200 text-gray-800 px-4 py-2 rounded hover:bg-gray-300">Back to Instructions</button>
                        <button id="next-to-analysis" class="bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700">Next: Market Analysis (Part 1)</button>
                    </div>
                </div>
                
                <!-- Analysis Tab -->
                <div id="content-analysis" class="tab-content hidden">
                    <h2 class="text-2xl font-semibold mb-4">Step 2: Housing Market Analysis (Part 1)</h2>
                    
                    <div class="mb-6">
                        <p class="mb-4">Based on your review of Redfin data for <span id="analysis-state">[your state]</span>, complete the analysis table below:</p>
                        
                        <div class="bg-blue-50 p-4 rounded-lg mb-4">
                            <h3 class="font-medium">How to Complete Part 1:</h3>
                            <ol class="list-decimal pl-5 space-y-1 mt-2">
                                <li><strong>Weight</strong>: Assign a weight to each metric based on how important you think it is (weights must sum to 100)
                                    <ul class="list-disc pl-5 mt-1">
                                        <li>If you think all metrics are equally important, assign 20 to each (5 × 20 = 100)</li>
                                        <li>If you think only one metric matters, that metric would get 100</li>
                                    </ul>
                                </li>
                                <li><strong>Value</strong>: Assign a value from 1-100 for each metric:
                                    <ul class="list-disc pl-5 mt-1">
                                        <li>Below 50: Market favors buyers (lower values = stronger buyers market)</li>
                                        <li>Above 50: Market favors sellers (higher values = stronger sellers market)</li>
                                        <li>Around 50: Balanced market</li>
                                    </ul>
                                </li>
                                <li><strong>Justification</strong>: Briefly explain your reasoning for each value</li>
                            </ol>
                        </div>
                        
                        <!-- Analysis Table -->
                        <div class="overflow-x-auto mb-6">
                            <table class="w-full border-collapse">
                                <thead>
                                    <tr>
                                        <th class="text-left border p-2 bg-gray-50">Housing Metric</th>
                                        <th class="text-center border p-2 bg-gray-50 w-24">Weight</th>
                                        <th class="text-center border p-2 bg-gray-50 w-24">Value</th>
                                        <th class="text-center border p-2 bg-gray-50 w-36">Weighted Value</th>
                                        <th class="text-left border p-2 bg-gray-50">Justification</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="border p-2">
                                            <div>
                                                <span class="font-medium">Median Sale Price</span>
                                                <p class="text-xs text-gray-500 mt-1">Balanced: 3-5% growth per year</p>
                                            </div>
                                        </td>
                                        <td class="border p-2">
                                            <input type="number" class="weight-input w-full text-center border rounded p-1" data-metric="price" min="0" max="100" value="20">
                                        </td>
                                        <td class="border p-2">
                                            <input type="number" class="value-input w-full text-center border rounded p-1" data-metric="price" min="1" max="100" value="50">
                                        </td>
                                        <td class="border p-2 text-center weighted-value" data-metric="price">10.00</td>
                                        <td class="border p-2">
                                            <textarea class="w-full border rounded p-1 text-sm" rows="2" placeholder="Enter justification"></textarea>
                                        </td>
                                    </tr>
                                    
                                    <tr>
                                        <td class="border p-2">
                                            <div>
                                                <span class="font-medium">Months' Supply</span>
                                                <p class="text-xs text-gray-500 mt-1">Balanced: 4-6 months</p>
                                            </div>
                                        </td>
                                        <td class="border p-2">
                                            <input type="number" class="weight-input w-full text-center border rounded p-1" data-metric="supply" min="0" max="100" value="20">
                                        </td>
                                        <td class="border p-2">
                                            <input type="number" class="value-input w-full text-center border rounded p-1" data-metric="supply" min="1" max="100" value="50">
                                        </td>
                                        <td class="border p-2 text-center weighted-value" data-metric="supply">10.00</td>
                                        <td class="border p-2">
                                            <textarea class="w-full border rounded p-1 text-sm" rows="2" placeholder="Enter justification"></textarea>
                                        </td>
                                    </tr>
                                    
                                    <tr>
                                        <td class="border p-2">
                                            <div>
                                                <span class="font-medium">Days on Market</span>
                                                <p class="text-xs text-gray-500 mt-1">Balanced: 30-60 days</p>
                                            </div>
                                        </td>
                                        <td class="border p-2">
                                            <input type="number" class="weight-input w-full text-center border rounded p-1" data-metric="days" min="0" max="100" value="20">
                                        </td>
                                        <td class="border p-2">
                                            <input type="number" class="value-input w-full text-center border rounded p-1" data-metric="days" min="1" max="100" value="50">
                                        </td>
                                        <td class="border p-2 text-center weighted-value" data-metric="days">10.00</td>
                                        <td class="border p-2">
                                            <textarea class="w-full border rounded p-1 text-sm" rows="2" placeholder="Enter justification"></textarea>
                                        </td>
                                    </tr>
                                    
                                    <tr>
                                        <td class="border p-2">
                                            <div>
                                                <span class="font-medium">Sale-to-List</span>
                                                <p class="text-xs text-gray-500 mt-1">Balanced: 98-102%</p>
                                            </div>
                                        </td>
                                        <td class="border p-2">
                                            <input type="number" class="weight-input w-full text-center border rounded p-1" data-metric="saleToList" min="0" max="100" value="20">
                                        </td>
                                        <td class="border p-2">
                                            <input type="number" class="value-input w-full text-center border rounded p-1" data-metric="saleToList" min="1" max="100" value="50">
                                        </td>
                                        <td class="border p-2 text-center weighted-value" data-metric="saleToList">10.00</td>
                                        <td class="border p-2">
                                            <textarea class="w-full border rounded p-1 text-sm" rows="2" placeholder="Enter justification"></textarea>
                                        </td>
                                    </tr>
                                    
                                    <tr>
                                        <td class="border p-2">
                                            <div>
                                                <span class="font-medium">Price Drops</span>
                                                <p class="text-xs text-gray-500 mt-1">Balanced: 10-20%</p>
                                            </div>
                                        </td>
                                        <td class="border p-2">
                                            <input type="number" class="weight-input w-full text-center border rounded p-1" data-metric="priceDrops" min="0" max="100" value="20">
                                        </td>
                                        <td class="border p-2">
                                            <input type="number" class="value-input w-full text-center border rounded p-1" data-metric="priceDrops" min="1" max="100" value="50">
                                        </td>
                                        <td class="border p-2 text-center weighted-value" data-metric="priceDrops">10.00</td>
                                        <td class="border p-2">
                                            <textarea class="w-full border rounded p-1 text-sm" rows="2" placeholder="Enter justification"></textarea>
                                        </td>
                                    </tr>
                                    
                                    <tr>
                                        <td class="border p-2 font-bold">Total</td>
                                        <td class="border p-2 font-bold text-center" id="total-weight">100</td>
                                        <td class="border p-2"></td>
                                        <td class="border p-2 font-bold text-center" id="total-weighted-value">50.00</td>
                                        <td class="border p-2"></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <div id="weight-warning" class="hidden text-red-600 mb-4 flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
                            </svg>
                            Weights must sum to 100. Please adjust your weights.
                        </div>
                        
                        <!-- Market Assessment Results -->
                        <div class="bg-white p-4 border rounded-lg">
                            <h3 class="font-medium mb-2">Part 1 Market Assessment:</h3>
                            <p class="text-lg">
                                The housing market in <span id="result-state">[your state]</span> is a 
                                <span id="market-type" class="font-bold">balanced</span> market with a score of 
                                <span id="final-score" class="font-bold">50.00</span>.
                            </p>
                            <div class="mt-4">
                                <div class="relative pt-1">
                                    <div class="flex justify-between mb-1">
                                        <span class="text-sm text-blue-700">Buyers Market</span>
                                        <span class="text-sm text-blue-700">Balanced Market</span>
                                        <span class="text-sm text-blue-700">Sellers Market</span>
                                    </div>
                                    <div class="overflow-hidden h-6 text-xs flex rounded bg-gray-200">
                                        <div class="w-1/3 bg-blue-300 rounded-l"></div>
                                        <div class="w-1/3 bg-green-300"></div>
                                        <div class="w-1/3 bg-red-300 rounded-r"></div>
                                        <div id="score-marker" class="absolute h-full w-1 bg-black" style="left: 50%"></div>
                                    </div>
                                    <div class="flex justify-between text-xs mt-1">
                                        <span>0</span>
                                        <span>40</span>
                                        <span>60</span>
                                        <span>100</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-4 p-4 bg-yellow-50 rounded-lg">
                            <p><strong>Important:</strong> One member of your group should enter your values in the Google Sheet provided by your TA.</p>
                        </div>
                    </div>
                    
                    <div class="flex justify-between mt-6">
                        <button id="back-to-state" class="bg-gray-200 text-gray-800 px-4 py-2 rounded hover:bg-gray-300">Back to State Selection</button>
                        <button id="next-to-data" class="bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700">Next: View Data</button>
                    </div>
                </div>
                
                <!-- Data Visualization Tab -->
                <div id="content-data" class="tab-content hidden">
                    <h2 class="text-2xl font-semibold mb-4">Step 3: Data Visualization</h2>
                    
                    <div class="mb-4 p-4 bg-yellow-50 rounded-lg">
                        <h3 class="font-medium">Data Analysis Instructions:</h3>
                        <ol class="list-decimal pl-5 space-y-1 mt-2">
                            <li>Use the charts below to analyze housing market trends for your state</li>
                            <li>Look at long-term trends and recent changes for each metric</li>
                            <li>Compare your state's data with national averages</li>
                            <li>Use these visualizations to help determine your values for each metric in Part 1</li>
                            <li>Remember the balanced market indicators for each metric:
                                <ul class="list-disc ml-5 mt-1">
                                    <li>Median Sale Price: 3-5% growth per year</li>
                                    <li>Months' Supply: 4-6 months</li>
                                    <li>Days on Market: 30-60 days</li>
                                    <li>Sale-to-List: 98-102%</li>
                                    <li>Price Drops: 10-20%</li>
                                </ul>
                            </li>
                        </ol>
                    </div>
                    
                    <div class="flex justify-between items-center mb-4">
                        <p class="text-lg">State: <span id="data-state" class="font-semibold">[your state]</span></p>
                        <div>
                            <label for="time-range" class="mr-2">Time Range:</label>
                            <select id="time-range" class="border rounded p-1">
                                <option value="12">Last 12 months</option>
                                <option value="24">Last 24 months</option>
                                <option value="60" selected>Last 5 years</option>
                                <option value="120">Last 10 years</option>
                                <option value="all">All available data</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="mb-8">
                        <h3 class="font-medium mb-3">Median Sale Price</h3>
                        <div class="bg-white p-4 rounded border">
                            <canvas id="priceChart" height="250"></canvas>
                        </div>
                        <div class="mt-2 p-3 bg-gray-100 rounded text-sm">
                            <p><strong>Balanced market indicator:</strong> 3-5% annual growth</p>
                            <p><strong>Current annual growth rate:</strong> <span id="price-growth" class="font-medium">+6.2%</span></p>
                            <p><strong>Analysis hint:</strong> Values above 5% annual growth suggest a seller's market (values > 50), while growth below 3% or negative growth suggests a buyer's market (values < 50).</p>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                        <div>
                            <h3 class="font-medium mb-3">Months of Supply (Inventory/Sales)</h3>
                            <div class="bg-white p-4 rounded border">
                                <canvas id="supplyChart" height="200"></canvas>
                            </div>
                            <div class="mt-2 p-3 bg-gray-100 rounded text-sm">
                                <p><strong>Balanced market:</strong> 4-6 months</p>
                                <p><strong>Current value:</strong> <span id="supply-value" class="font-medium">2.1 months</span></p>
                                <p><strong>Analysis hint:</strong> Lower supply favors sellers (values > 50), higher supply favors buyers (values < 50).</p>
                            </div>
                        </div>
                        
                        <div>
                            <h3 class="font-medium mb-3">Days on Market</h3>
                            <div class="bg-white p-4 rounded border">
                                <canvas id="daysChart" height="200"></canvas>
                            </div>
                            <div class="mt-2 p-3 bg-gray-100 rounded text-sm">
                                <p><strong>Balanced market:</strong> 30-60 days</p>
                                <p><strong>Current value:</strong> <span id="days-value" class="font-medium">15 days</span></p>
                                <p><strong>Analysis hint:</strong> Fewer days favors sellers (values > 50), more days favors buyers (values < 50).</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                        <div>
                            <h3 class="font-medium mb-3">Sale-to-List Ratio</h3>
                            <div class="bg-white p-4 rounded border">
                                <canvas id="saleToListChart" height="200"></canvas>
                            </div>
                            <div class="mt-2 p-3 bg-gray-100 rounded text-sm">
                                <p><strong>Balanced market:</strong> 98-102%</p>
                                <p><strong>Current value:</strong> <span id="sale-to-list-value" class="font-medium">101.5%</span></p>
                                <p><strong>Analysis hint:</strong> Ratios above 102% favor sellers (values > 50), ratios below 98% favor buyers (values < 50).</p>
                            </div>
                        </div>
                        
                        <div>
                            <h3 class="font-medium mb-3">Price Drops (Estimated)</h3>
                            <div class="bg-white p-4 rounded border">
                                <canvas id="priceDropsChart" height="200"></canvas>
                            </div>
                            <div class="mt-2 p-3 bg-gray-100 rounded text-sm">
                                <p><strong>Balanced market:</strong> 10-20% of listings</p>
                                <p><strong>Current value:</strong> <span id="price-drops-value" class="font-medium">7%</span></p>
                                <p><strong>Analysis hint:</strong> Lower percentage of price drops favors sellers (values > 50), higher percentage favors buyers (values < 50).</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="p-4 bg-blue-50 rounded-lg mb-6">
                        <h3 class="font-medium">Workflow Reminder:</h3>
                        <ol class="list-decimal pl-5 mt-2">
                            <li>Use these visualizations to help you complete your Part 1 analysis</li>
                            <li>After determining your weights and values for each metric, enter them in the Analysis table</li>
                            <li>One group member should input your final values into the Google Sheet provided by your TA</li>
                            <li>The TA will download this sheet and create maps showing each state's market assessment</li>
                            <li>Later, you'll do the same process with AI feedback to create comparison maps</li>
                        </ol>
                    </div>
                    
                    <div class="flex justify-between mt-6">
                        <button id="back-to-analysis" class="bg-gray-200 text-gray-800 px-4 py-2 rounded hover:bg-gray-300">Back to Analysis (Part 1)</button>
                        <button id="next-to-ai" class="bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700">Next: Get AI Feedback (Part 2)</button>
                    </div>
                </div>
                
                <!-- AI Feedback Tab -->
                <div id="content-ai" class="tab-content hidden">
                    <h2 class="text-2xl font-semibold mb-4">Step 4: AI Feedback (Part 2)</h2>
                    
                    <div class="mb-6">
                        <p>In this step, you'll get an AI assessment of your state's housing market and compare it with your own analysis from Part 1.</p>
                        
                        <div class="bg-blue-50 p-4 rounded-lg my-4">
                            <h3 class="font-medium">How to Get AI Feedback:</h3>
                            <ol class="list-decimal pl-5 space-y-1 mt-2">
                                <li>Get the Excel data file for your state from your TA (either Activity1Template.xlsx or ask your TA for your state's data)</li>
                                <li>Choose an AI tool: <a href="https://chat.openai.com" target="_blank" class="text-blue-600 underline">ChatGPT</a>, <a href="https://perplexity.ai" target="_blank" class="text-blue-600 underline">Perplexity</a>, <a href="https://mistral.ai" target="_blank" class="text-blue-600 underline">Mistral</a>, or <a href="https://claude.ai" target="_blank" class="text-blue-600 underline">Claude</a> (note: Claude Pro may be needed)</li>
                                <li>Upload the Excel file to the AI tool</li>
                                <li>Copy and paste the prompt below (make sure to replace [YOUR STATE] with your state name)</li>
                                <li>Enter the AI's responses in the results section below</li>
                            </ol>
                        </div>
                        
                        <!-- AI Prompt Section -->
                        <div class="mb-6">
                            <h3 class="font-medium mb-2">AI Prompt to Use:</h3>
                            <div class="bg-gray-100 p-4 rounded-lg">
                                <p class="text-sm font-mono" id="ai-prompt">Examine this data and assess the health of the [YOUR STATE] housing market. Fill out the table where 1 is a market where nothing is selling because there are literally no buyers and 100 is an overheated market, where homes are sold before they even hit the market, and it is hard to find a house to purchase. Give me your final total weighted value and provide a justification for your response.

Housing Metric | Weight | Value | Weighted Value (Weight/100 x Value)
--------------|--------|-------|----------------------------------
Median Sale Price | | | 
Months' Supply | | |
Days on Market | | |
Sale-to-List | | |
Price Drops | | |
Total | Must Sum to 100 | |</p>
                                <button id="copy-prompt" class="mt-3 bg-gray-200 text-gray-800 px-3 py-1 rounded text-sm hover:bg-gray-300">Copy to Clipboard</button>
                            </div>
                            <p class="text-sm text-gray-600 italic mt-2">Note: If the AI asks for the data, make sure you've uploaded the Excel file provided by your TA.</p>
                        </div>
                        
                        <!-- AI Results Section -->
                        <div class="mb-6">
                            <h3 class="font-medium mb-2">Enter AI Analysis Results:</h3>
                            
                            <!-- AI Analysis Table -->
                            <div class="overflow-x-auto mb-4">
                                <table class="w-full border-collapse">
                                    <thead>
                                        <tr>
                                            <th class="text-left border p-2 bg-gray-50">Housing Metric</th>
                                            <th class="text-center border p-2 bg-gray-50 w-24">AI Weight</th>
                                            <th class="text-center border p-2 bg-gray-50 w-24">AI Value</th>
                                            <th class="text-center border p-2 bg-gray-50 w-36">AI Weighted Value</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="border p-2">Median Sale Price</td>
                                            <td class="border p-2">
                                                <input type="number" class="ai-weight-input w-full text-center border rounded p-1" data-metric="price" min="0" max="100">
                                            </td>
                                            <td class="border p-2">
                                                <input type="number" class="ai-value-input w-full text-center border rounded p-1" data-metric="price" min="1" max="100">
                                            </td>
                                            <td class="border p-2 text-center ai-weighted-value" data-metric="price">0.00</td>
                                        </tr>
                                        
                                        <tr>
                                            <td class="border p-2">Months' Supply</td>
                                            <td class="border p-2">
                                                <input type="number" class="ai-weight-input w-full text-center border rounded p-1" data-metric="supply" min="0" max="100">
                                            </td>
                                            <td class="border p-2">
                                                <input type="number" class="ai-value-input w-full text-center border rounded p-1" data-metric="supply" min="1" max="100">
                                            </td>
                                            <td class="border p-2 text-center ai-weighted-value" data-metric="supply">0.00</td>
                                        </tr>
                                        
                                        <tr>
                                            <td class="border p-2">Days on Market</td>
                                            <td class="border p-2">
                                                <input type="number" class="ai-weight-input w-full text-center border rounded p-1" data-metric="days" min="0" max="100">
                                            </td>
                                            <td class="border p-2">
                                                <input type="number" class="ai-value-input w-full text-center border rounded p-1" data-metric="days" min="1" max="100">
                                            </td>
                                            <td class="border p-2 text-center ai-weighted-value" data-metric="days">0.00</td>
                                        </tr>
                                        
                                        <tr>
                                            <td class="border p-2">Sale-to-List</td>
                                            <td class="border p-2">
                                                <input type="number" class="ai-weight-input w-full text-center border rounded p-1" data-metric="saleToList" min="0" max="100">
                                            </td>
                                            <td class="border p-2">
                                                <input type="number" class="ai-value-input w-full text-center border rounded p-1" data-metric="saleToList" min="1" max="100">
                                            </td>
                                            <td class="border p-2 text-center ai-weighted-value" data-metric="saleToList">0.00</td>
                                        </tr>
                                        
                                        <tr>
                                            <td class="border p-2">Price Drops</td>
                                            <td class="border p-2">
                                                <input type="number" class="ai-weight-input w-full text-center border rounded p-1" data-metric="priceDrops" min="0" max="100">
                                            </td>
                                            <td class="border p-2">
                                                <input type="number" class="ai-value-input w-full text-center border rounded p-1" data-metric="priceDrops" min="1" max="100">
                                            </td>
                                            <td class="border p-2 text-center ai-weighted-value" data-metric="priceDrops">0.00</td>
                                        </tr>
                                        
                                        <tr>
                                            <td class="border p-2 font-bold">Total</td>
                                            <td class="border p-2 font-bold text-center" id="ai-total-weight">0</td>
                                            <td class="border p-2"></td>
                                            <td class="border p-2 font-bold text-center" id="ai-total-weighted-value">0.00</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <div id="ai-weight-warning" class="hidden text-red-600 mb-4 flex items-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
                                </svg>
                                AI weights should sum to 100. Please check your entries.
                            </div>
                            
                            <div class="mb-4">
                                <label for="ai-justification" class="block text-gray-700 mb-2">AI's Justification:</label>
                                <textarea id="ai-justification" class="w-full border rounded p-2" rows="4" placeholder="Enter the AI's justification for its analysis..."></textarea>
                            </div>
                            
                            <div class="mt-4 p-4 bg-yellow-50 rounded-lg">
                                <p><strong>Important:</strong> One member of your group should enter the AI values in the Google Sheet provided by your TA.</p>
                            </div>
                        </div>
                        
                        <!-- Comparison Section -->
                        <div class="mb-6">
                            <h3 class="font-medium mb-2">Analysis Comparison:</h3>
                            <div class="bg-gray-100 p-4 rounded-lg">
                                <p class="mb-2">Your analysis rates the housing market as a <span id="your-market-type" class="font-bold">balanced</span> market with a score of <span id="your-score" class="font-bold">50.00</span>.</p>
                                <p class="mb-4">The AI rates it as a <span id="ai-market-type" class="font-bold">undefined</span> market with a score of <span id="ai-score" class="font-bold">0.00</span>.</p>
                                
                                <div class="mt-2">
                                    <h4 class="font-medium text-sm mb-1">Score Comparison:</h4>
                                    <div class="relative h-8 bg-gray-300 rounded-full">
                                        <div class="absolute inset-0 flex items-center justify-center text-xs font-medium">0 ← Buyers Market | Balanced Market | Sellers Market → 100</div>
                                        <div id="your-score-marker" class="absolute h-8 w-2 bg-blue-600 top-0" style="left: 50%"></div>
                                        <div id="ai-score-marker" class="absolute h-8 w-2 bg-green-600 top-0" style="left: 0%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Reflection Questions -->
                        <div class="mb-6">
                            <h3 class="font-medium mb-4">Reflection Questions:</h3>
                            <p class="mb-2 text-sm italic">Spend 1-3 sentences answering each of the following questions. Be ready to share your answers with your classmates.</p>
                            
                            <div class="space-y-4">
                                <div>
                                    <p class="font-medium text-sm">1. Given that housing market trends can vary significantly by region, what additional regional data would have helped your group better understand the specific dynamics of your state's housing market compared to national trends?</p>
                                    <textarea class="w-full border rounded p-2 mt-1" rows="2"></textarea>
                                </div>
                                
                                <div>
                                    <p class="font-medium text-sm">2. How did the AI's process for evaluating the housing market data differ from your group's approach? Did the AI's response alter how you thought about your housing market?</p>
                                    <textarea class="w-full border rounded p-2 mt-1" rows="2"></textarea>
                                </div>
                                
                                <div>
                                    <p class="font-medium text-sm">3. How much do you believe the framing of the prompt given to the AI influences the output? Do you think the AI would generate a different assessment if the prompt was worded differently, emphasizing different priorities?</p>
                                    <textarea class="w-full border rounded p-2 mt-1" rows="2"></textarea>
                                </div>
                                
                                <div>
                                    <p class="font-medium text-sm">4. Could an over-reliance on AI-generated assessments lead to unintended consequences, such as exacerbating existing inequalities in the housing market or reducing the role of human expertise?</p>
                                    <textarea class="w-full border rounded p-2 mt-1" rows="2"></textarea>
                                </div>
                                
                                <div>
                                    <p class="font-medium text-sm">5. How do you feel about using AI in your education more generally, and for this exercise in particular? Are there aspects of AI integration that you find beneficial or concerning?</p>
                                    <textarea class="w-full border rounded p-2 mt-1" rows="2"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-between mt-6">
                        <button id="back-to-data" class="bg-gray-200 text-gray-800 px-4 py-2 rounded hover:bg-gray-300">Back to Data Visualization</button>
                        <button id="finish-activity" class="bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700">Finish Activity</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Completion Modal (Hidden by default) -->
        <div id="completion-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-lg p-6 max-w-md w-full">
                <h2 class="text-2xl font-bold mb-4">Activity Completed!</h2>
                <p class="mb-4">You have successfully completed the Housing Market Analysis activity.</p>
                <p class="mb-6">Your final assessment: The housing market in <span id="modal-state">[your state]</span> is a <span id="modal-market-type" class="font-bold">balanced</span> market with a score of <span id="modal-score" class="font-bold">50.00</span>.</p>
                <div class="flex justify-end space-x-3">
                    <a href="ta-dashboard.html" class="bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700">View Dashboard</a>
                    <button id="close-modal" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Return to Activities</button>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-100 border-t mt-12 py-6 px-4">
        <div class="container mx-auto">
            <p class="text-gray-600">© 2025 Economics Department</p>
        </div>
    </footer>

    <!-- JavaScript for functionality -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Tab switching functionality
            const tabButtons = document.querySelectorAll('.tab-btn');
            const tabContents = document.querySelectorAll('.tab-content');
            
            function updateProgressBar(step) {
                const labels = ['Instructions', 'Choose State', 'Market Analysis', 'Data Visualization', 'AI Feedback'];
                const percentages = [20, 40, 60, 80, 100];
                
                document.getElementById('progress-label').textContent = `Step ${step}: ${labels[step-1]}`;
                document.getElementById('progress-counter').textContent = `Step ${step} of 5`;
                document.getElementById('progress-bar').style.width = `${percentages[step-1]}%`;
            }
            
            function showTab(tabId, step) {
                // Hide all tab contents
                tabContents.forEach(content => {
                    content.classList.add('hidden');
                });
                
                // Remove active class from all tab buttons
                tabButtons.forEach(btn => {
                    btn.classList.remove('border-blue-600', 'text-blue-600');
                    btn.classList.add('border-transparent');
                });
                
                // Show the selected tab content
                document.getElementById('content-' + tabId).classList.remove('hidden');
                
                // Add active class to the clicked tab button
                document.getElementById('tab-' + tabId).classList.add('border-blue-600', 'text-blue-600');
                document.getElementById('tab-' + tabId).classList.remove('border-transparent');
                
                // Update progress bar
                if (step) {
                    updateProgressBar(step);
                }
            }
            
            // Add click event to tab buttons
            tabButtons.forEach((btn, index) => {
                btn.addEventListener('click', function() {
                    const tabId = this.id.replace('tab-', '');
                    showTab(tabId, index + 1);
                });
            });
            
            // Navigation button events
            document.getElementById('next-to-state').addEventListener('click', function() {
                showTab('state', 2);
            });
            
            document.getElementById('back-to-instructions').addEventListener('click', function() {
                showTab('instructions', 1);
            });
            
            document.getElementById('next-to-analysis').addEventListener('click', function() {
                const stateSelect = document.getElementById('state-select');
                const selectedState = stateSelect.options[stateSelect.selectedIndex].text;
                
                document.getElementById('analysis-state').textContent = selectedState;
                document.getElementById('result-state').textContent = selectedState;
                document.getElementById('data-state').textContent = selectedState;
                document.getElementById('modal-state').textContent = selectedState;
                
                showTab('analysis', 3);
            });
            
            document.getElementById('back-to-state').addEventListener('click', function() {
                showTab('state', 2);
            });
            
            document.getElementById('next-to-data').addEventListener('click', function() {
                showTab('data', 4);
                initCharts(); // Initialize charts when showing the tab
            });
            
            document.getElementById('back-to-analysis').addEventListener('click', function() {
                showTab('analysis', 3);
            });
            
            document.getElementById('next-to-ai').addEventListener('click', function() {
                // Update AI prompt with selected state
                const stateSelect = document.getElementById('state-select');
                const selectedState = stateSelect.options[stateSelect.selectedIndex].text;
                
                const promptText = document.getElementById('ai-prompt').textContent;
                document.getElementById('ai-prompt').textContent = promptText.replace('[YOUR STATE]', selectedState);
                
                // Update comparison section
                document.getElementById('your-market-type').textContent = document.getElementById('market-type').textContent;
                document.getElementById('your-score').textContent = document.getElementById('final-score').textContent;
                
                const score = parseFloat(document.getElementById('final-score').textContent);
                document.getElementById('your-score-marker').style.left = `${score}%`;
                
                showTab('ai', 5);
            });
            
            document.getElementById('back-to-data').addEventListener('click', function() {
                showTab('data', 4);
            });
            
            document.getElementById('finish-activity').addEventListener('click', function() {
                document.getElementById('completion-modal').classList.remove('hidden');
            });
            
            document.getElementById('close-modal').addEventListener('click', function() {
                document.getElementById('completion-modal').classList.add('hidden');
                window.location.href = 'index.html';
            });
            
            // Analysis calculations
            const weightInputs = document.querySelectorAll('.weight-input');
            const valueInputs = document.querySelectorAll('.value-input');
            
            function updateWeightedValues() {
                let totalWeight = 0;
                let totalWeightedValue = 0;
                
                weightInputs.forEach(input => {
                    const metric = input.dataset.metric;
                    const weight = parseFloat(input.value) || 0;
                    const valueInput = document.querySelector(`.value-input[data-metric="${metric}"]`);
                    const value = parseFloat(valueInput.value) || 0;
                    const weightedValue = (weight / 100) * value;
                    
                    document.querySelector(`.weighted-value[data-metric="${metric}"]`).textContent = weightedValue.toFixed(2);
                    
                    totalWeight += weight;
                    totalWeightedValue += weightedValue;
                });
                
                // Update totals
                document.getElementById('total-weight').textContent = totalWeight;
                document.getElementById('total-weighted-value').textContent = totalWeightedValue.toFixed(2);
                document.getElementById('final-score').textContent = totalWeightedValue.toFixed(2);
                document.getElementById('modal-score').textContent = totalWeightedValue.toFixed(2);
                
                // Update score marker position (0-100%)
                document.getElementById('score-marker').style.left = `${totalWeightedValue}%`;
                
                // Show/hide weight warning
                if (totalWeight !== 100) {
                    document.getElementById('weight-warning').classList.remove('hidden');
                } else {
                    document.getElementById('weight-warning').classList.add('hidden');
                }
                
                // Update market type
                const marketType = totalWeightedValue < 40 ? 'buyers' : totalWeightedValue > 60 ? 'sellers' : 'balanced';
                document.getElementById('market-type').textContent = marketType;
                document.getElementById('modal-market-type').textContent = marketType;
            }
            
            // Add input event listeners for analysis table
            weightInputs.forEach(input => {
                input.addEventListener('input', updateWeightedValues);
            });
            
            valueInputs.forEach(input => {
                input.addEventListener('input', updateWeightedValues);
            });
            
            // AI analysis calculations
            const aiWeightInputs = document.querySelectorAll('.ai-weight-input');
            const aiValueInputs = document.querySelectorAll('.ai-value-input');
            
            function updateAIWeightedValues() {
                let totalWeight = 0;
                let totalWeightedValue = 0;
                
                aiWeightInputs.forEach(input => {
                    const metric = input.dataset.metric;
                    const weight = parseFloat(input.value) || 0;
                    const valueInput = document.querySelector(`.ai-value-input[data-metric="${metric}"]`);
                    const value = parseFloat(valueInput.value) || 0;
                    const weightedValue = (weight / 100) * value;
                    
                    document.querySelector(`.ai-weighted-value[data-metric="${metric}"]`).textContent = weightedValue.toFixed(2);
                    
                    totalWeight += weight;
                    totalWeightedValue += weightedValue;
                });
                
                // Update totals
                document.getElementById('ai-total-weight').textContent = totalWeight;
                document.getElementById('ai-total-weighted-value').textContent = totalWeightedValue.toFixed(2);
                document.getElementById('ai-score').textContent = totalWeightedValue.toFixed(2);
                
                // Update AI score marker position (0-100%)
                document.getElementById('ai-score-marker').style.left = `${totalWeightedValue}%`;
                
                // Show/hide weight warning
                if (totalWeight !== 100 && totalWeight !== 0) {
                    document.getElementById('ai-weight-warning').classList.remove('hidden');
                } else {
                    document.getElementById('ai-weight-warning').classList.add('hidden');
                }
                
                // Update AI market type if there's a value
                if (totalWeightedValue > 0) {
                    const marketType = totalWeightedValue < 40 ? 'buyers' : totalWeightedValue > 60 ? 'sellers' : 'balanced';
                    document.getElementById('ai-market-type').textContent = marketType;
                }
            }
            
            // Add input event listeners for AI analysis table
            aiWeightInputs.forEach(input => {
                input.addEventListener('input', updateAIWeightedValues);
            });
            
            aiValueInputs.forEach(input => {
                input.addEventListener('input', updateAIWeightedValues);
            });
            
            // Copy prompt to clipboard
            document.getElementById('copy-prompt').addEventListener('click', function() {
                const promptText = document.getElementById('ai-prompt').textContent;
                navigator.clipboard.writeText(promptText).then(() => {
                    this.textContent = 'Copied!';
                    setTimeout(() => {
                        this.textContent = 'Copy to Clipboard';
                    }, 2000);
                });
            });
            
            // File upload handling
            document.getElementById('upload-btn').addEventListener('click', function() {
                document.getElementById('file-input').click();
            });
            
            document.getElementById('file-input').addEventListener('change', function() {
                if (this.files.length > 0) {
                    document.getElementById('upload-area').classList.add('hidden');
                    document.getElementById('file-uploaded').classList.remove('hidden');
                    document.getElementById('filename').textContent = this.files[0].name;
                }
            });
            
            document.getElementById('remove-file').addEventListener('click', function() {
                document.getElementById('file-input').value = '';
                document.getElementById('upload-area').classList.remove('hidden');
                document.getElementById('file-uploaded').classList.add('hidden');
            });
            
            // Initialize charts with sample data
            function initCharts() {
                // Sample data - would be replaced with actual data
                const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'];
                const stateData = [350000, 355000, 360000, 365000, 370000, 380000];
                const nationalData = [320000, 322000, 325000, 330000, 335000, 338000];
                
                // Median Sale Price Chart
                const priceCtx = document.getElementById('priceChart').getContext('2d');
                new Chart(priceCtx, {
                    type: 'line',
                    data: {
                        labels: months,
                        datasets: [
                            {
                                label: 'Your State',
                                data: stateData,
                                borderColor: 'rgb(59, 130, 246)',
                                backgroundColor: 'rgba(59, 130, 246, 0.1)',
                                tension: 0.1,
                                fill: true
                            },
                            {
                                label: 'National',
                                data: nationalData,
                                borderColor: 'rgb(156, 163, 175)',
                                backgroundColor: 'rgba(156, 163, 175, 0.1)',
                                tension: 0.1,
                                fill: true,
                                borderDash: [5, 5]
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'Months\' Supply'
                            }
                        }
                    }
                });
                
                // Days on Market Chart
                const daysCtx = document.getElementById('daysChart').getContext('2d');
                new Chart(daysCtx, {
                    type: 'line',
                    data: {
                        labels: months,
                        datasets: [
                            {
                                label: 'Your State',
                                data: [25, 23, 20, 18, 15, 14],
                                borderColor: 'rgb(59, 130, 246)',
                                tension: 0.1
                            },
                            {
                                label: 'National',
                                data: [30, 28, 27, 25, 23, 22],
                                borderColor: 'rgb(156, 163, 175)',
                                tension: 0.1,
                                borderDash: [5, 5]
                            },
                            {
                                label: 'Balanced Market Min',
                                data: [30, 30, 30, 30, 30, 30],
                                borderColor: 'rgba(34, 197, 94, 0.3)',
                                tension: 0,
                                borderDash: [2, 2]
                            },
                            {
                                label: 'Balanced Market Max',
                                data: [60, 60, 60, 60, 60, 60],
                                borderColor: 'rgba(34, 197, 94, 0.3)',
                                tension: 0,
                                borderDash: [2, 2]
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'Days on Market'
                            }
                        }
                    }
                });
                
                // Sale-to-List Ratio Chart
                const saleToListCtx = document.getElementById('saleToListChart').getContext('2d');
                new Chart(saleToListCtx, {
                    type: 'line',
                    data: {
                        labels: months,
                        datasets: [
                            {
                                label: 'Your State',
                                data: [100.5, 101.2, 102.0, 101.8, 101.0, 100.7],
                                borderColor: 'rgb(59, 130, 246)',
                                tension: 0.1
                            },
                            {
                                label: 'National',
                                data: [99.8, 100.0, 100.5, 100.7, 100.2, 99.5],
                                borderColor: 'rgb(156, 163, 175)',
                                tension: 0.1,
                                borderDash: [5, 5]
                            },
                            {
                                label: 'Balanced Market Min',
                                data: [98, 98, 98, 98, 98, 98],
                                borderColor: 'rgba(34, 197, 94, 0.3)',
                                tension: 0,
                                borderDash: [2, 2]
                            },
                            {
                                label: 'Balanced Market Max',
                                data: [102, 102, 102, 102, 102, 102],
                                borderColor: 'rgba(34, 197, 94, 0.3)',
                                tension: 0,
                                borderDash: [2, 2]
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'Sale-to-List Ratio (%)'
                            }
                        }
                    }
                });
                
                // Price Drops Chart
                const priceDropsCtx = document.getElementById('priceDropsChart').getContext('2d');
                new Chart(priceDropsCtx, {
                    type: 'line',
                    data: {
                        labels: months,
                        datasets: [
                            {
                                label: 'Your State',
                                data: [12, 11, 9, 8, 7, 6],
                                borderColor: 'rgb(59, 130, 246)',
                                tension: 0.1
                            },
                            {
                                label: 'National',
                                data: [15, 14, 13, 12, 11, 10],
                                borderColor: 'rgb(156, 163, 175)',
                                tension: 0.1,
                                borderDash: [5, 5]
                            },
                            {
                                label: 'Balanced Market Min',
                                data: [10, 10, 10, 10, 10, 10],
                                borderColor: 'rgba(34, 197, 94, 0.3)',
                                tension: 0,
                                borderDash: [2, 2]
                            },
                            {
                                label: 'Balanced Market Max',
                                data: [20, 20, 20, 20, 20, 20],
                                borderColor: 'rgba(34, 197, 94, 0.3)',
                                tension: 0,
                                borderDash: [2, 2]
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'Price Drops (%)'
                            }
                        }
                    }
                });
            }
            
            // Initialize weighted values on page load
            updateWeightedValues();
        });
    </script>
</body>
</html>,
                        plugins: {
                            title: {
                                display: true,
                                text: 'Median Sale Price ($)'
                            }
                        }
                    }
                });
                
                // Months' Supply Chart
                const supplyCtx = document.getElementById('supplyChart').getContext('2d');
                new Chart(supplyCtx, {
                    type: 'line',
                    data: {
                        labels: months,
                        datasets: [
                            {
                                label: 'Your State',
                                data: [3.2, 3.0, 2.8, 2.5, 2.2, 2.0],
                                borderColor: 'rgb(59, 130, 246)',
                                tension: 0.1
                            },
                            {
                                label: 'National',
                                data: [3.8, 3.6, 3.5, 3.3, 3.2, 3.0],
                                borderColor: 'rgb(156, 163, 175)',
                                tension: 0.1,
                                borderDash: [5, 5]
                            },
                            {
                                label: 'Balanced Market Min',
                                data: [4, 4, 4, 4, 4, 4],
                                borderColor: 'rgba(34, 197, 94, 0.3)',
                                tension: 0,
                                borderDash: [2, 2]
                            },
                            {
                                label: 'Balanced Market Max',
                                data: [6, 6, 6, 6, 6, 6],
                                borderColor: 'rgba(34, 197, 94, 0.3)',
                                tension: 0,
                                borderDash: [2, 2]
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false